\section{Введение}

\Comment{TODO: в этом разделе должно остаться только краткое описание
проблемы и вклада статьи; формулы нужно убрать, подробные обзоры
перенести в related\_work.tex.}

Тема данной работы касается проблемы извлечения информации о перемещении
объекта в трехмерном пространстве по видео.

Отслеживание "--- \term{трекинг} "--- положения объекта в 3D требуется в
приложениях дополненной реальности\cite{Radkowski}, во многих задачах
робототехники\cite{Robotics} и других приложениях, где необходимо понимание
окружающего простанства по видео.
Одно из применений трекинг находит в создании видеоэффектов в кино, где часто
требуется отследить на видео некоторый объект с целью придания ему затем
дополнительных свойств\cite{Bugaev_2018_ECCV}.

Данная работа посвящена одной из задач, касающихся упомянутой проблемы "---
задаче рекурсивного трекинга 6D-позиции объекта, заданного 3D-моделью, на
видео.
Выражение «6D-позиция» происходит от того, что положение объекта в трехмерном
пространстве имеет шесть степеней свободы\cite{TeorMech}.
Входными данными данной задачи являются видео, снятое с единственной
камеры с известными параметрами, 3D-модель отслеживаемого объекта
и его позиция в трехмерном пространстве на начальном кадре видео.
В процессе выполнения алгоритм решения задачи должен последовательно вычислять
позиции объекта относительно камеры в каждом кадре видео, опираясь лишь на
исходные данные и информацию, вычисленную на предыдущих кадрах.
Наличие лишь одного кадра с известной позицией объекта и необходимость в
последовательном вычислении позиций являются существенными особенностями данной
задачи.
Они отличают ее от схожих задач, таких как детектирование 6D-позиции объекта на
изображениях или трекинг 6D-позиции с использованием ключевых кадров "---
нескольких изображений с известной позицией объекта.

Постановка задачи подразумевает, что отслеживаемый объект может быть
произвольным и на момент начала трекинга известно лишь одно его изображение.
В связи с этим известные на текущий момент методы решения задачи опираются
не на машинное обучение, а на классические методы компьютерного зрения.
Их можно классифицировать в зависимости от того, на какого рода особенности
изображения они опираются "--- цветовые, точечные, граничные и т.\,п.
Различные особенности позволяют в разной степени противостоять возможным
случаям, представляющим существенные сложности для алгоритмов трекинга.
Такими являются захламленный фон, смазывание видео при быстром движении,
быстрая перемена освещения, предметы, перекрывающие объект,
однородная текстура объекта, его симметричная форма.

Многие алгоритмы основаны на поиске и отслеживании точечных особенностей
(ключевых точек) изображения.
Основная их идея состоит в вычислении оптического потока в окрестностях
ключевых точек между соседними кадрами (например, алгоритмом
Лукаса-Канаде~\cite{LukasKanade}) и нахождении параметров трансформации объекта
по соответствиям двумерных и трёхмерных точек (решение задачи
Perspective-n-Point~\cite{PnPRansac}).
Такие методы позволяют устойчиво отслеживать хорошо текстурированные объекты и
могут работать при перемене освещения между кадрами.
Примерами таких алгоритмов являются~\cite{LourakisFeatures} (ещё ссылку сюда). 

Тем не менее, на однородных по текстуре объектах может быть очень мало ключевых
точек, и в такой ситуации отслеживать положение объекта по ним не получится.
Одним из способов преодоления этой проблемы является отслеживание контура
объекта.
Для этого выделяют границы на изображении и среди них ищут те, что могут
относиться к контуру. (ссылки)

%Примерами таких алгоритмов являются (ссылку сюда), исользующий что-то и
%(ссылку сюда), идея которого состоит в том, чтобы... 

Алгоритмы на основе поиска контуров способны отследить слабо текстурированные
объекты, но также обладают некоторыми недостатками.
По контуру не всегда можно однозначно восстановить позицию объекта, особенно в
случае, когда объект симметричен, и трекинг может сильно ошибаться при
возникновении таких неоднозначностей.

В последние годы получили активно развиваются алгоритмы, основанные на
распределении цветов в отдельных областях изображения (region-based methods).
Они собирают статистику того, насколько часто пиксели различных цветов
встречаются на проекции объекта и на окружающем фоне.
На каждом новом кадре позиция ищется таким образом, чтобы проекция объекта
наилучшим образом соответствовала собранной статистике.
Одним из первых таких алгоритмов стал PWP3D \cite{PWP3D}, в котором строилась
гистограмма цветов на проекции объекта и на фоне.
В нём была введена функция ошибки, определяющая апостериорную вероятность
позиции в соответствии с гистограммой.
Этот алгоритм был развит в работах (ссылки, ссылки), в которых гистограммы
строились для отдельных областей, с тем чтобы подсчитывать статистику по цвету
локально и повысить устойчивость к зашумлённым и пёстрым изображениям.
Эти алгоритмы показывают неплохие результаты (ссылка), решая проблему слабо
текстурированных изображений, и частично решая проблему смазывания, но, как и
методы на основе контуров, плохо справляются с симметричными объектами, и кроме
того неустойчивы к резкой смене освещения.

Также стоит отметить алгоритмы, собирающие попиксельную информацию, но
анализирующих не цвет, а дескрипторы отдельных пикселей (ссылка на Photometric
методы).

Таким образом, существуют различные факторы, влияющие на качество трекинга
различными алгоритмами: текстурированность объекта, наличие смазывания,
симметричность объекта, скорость движения и т. д.
Различные алгоритмы по-разному справляются с этими условиями, и там, где один
сбивается, другой может работать стабильно.
Отдельным фактором, влияющим на выбор алгоритма, является ограничение на время
работы, которое может быть различно для разных задач.

В данной работе проведена попытка одновеменно исользовать инфомацию о
распределении цветов на проекции и фоне на предыдущих изображениях и информацию
о ключевых точках.
Подход на основе распределения цветов выбран, так как подходит для любых типов
текстур, устойчив при несильном смазывании и показывающий хорошие
результаты~\cite{Tjaden2018}.
Добавление к нему информации о ключевых точках позволяет разрешить
неопределённость, связанную с симметричностью объектов, и кроме того привлекает
информацию о внутренней области проекции, тогда как алгоритмы, основанные на
цветах, используют в основном информацию о пикселях вокруг контура.

В последнее время предпринимались попытки совместить различные подходы в
алгоритмах трекинга.
К ним относится, например,~\cite{Bugaev_2018_ECCV}, где ключевые точки
исользуются для инициализации контурного метода, а затем совместно с контурами
применяются для улучшения позиции.
(упомянуть~\cite{ColorFeature2018})

Интересен подход (ссылка на RegioBasedPhotometric), в котором области вокруг
границ объекта отслеживаются с использованием цветовых гистограмм, а для того,
чтобы контролировать соответствие внутренней части проекции изображению,
используются дескрипторы пикселей, основанные на градиенте изображения.
Таким образом, алгоритм преодолевает неоднозначности, вызванные симметричностью
объекта.

%При этом, в случае, если изображение зашумлено, то значения дескрипторов, соответствующие одним и тем же точкам, могут сильно изменяться, и это приведёт к зашумлённости функции ошибки  и наличию локальных минимумов.

Предлагаемый в данной статье подход отличается тем, что использует не все
пиксели из внутренней части проекции, а только ключевые точки, уверенность в
положении которых может быть выше, чем в постоянстве дескрипторов, описывающих
произвольные точки на текстуре.

Рассматриваются два способа совмещения.
Один из них использует метод ключевых точек для первоначальной оценки положения
объекта и инициализации цветового метода, то есть применяет алгоритмы
последовательно.
Второй способ строит совместную функцкию энергии, основанную как на цветовых
гистограммах, так и на особых точках и минимизирует её.

Дальнейшие главы организованы следующим образом: во второй главе метод ключевых
точек и метод цветовых гистограмм описаны по отедльности, в третьей главе
раскрываются способы их объединения, в четвёртой описывается тестирование и
оценка результатов.
