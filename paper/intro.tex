\section{Введение}

Тема данной работы касается проблемы извлечения информации о перемещении
объекта в трехмерном пространстве по видео.

Отслеживание "--- \term{трекинг} "--- положения объекта в 3D требуется в
приложениях дополненной реальности\cite{Radkowski}, во многих задачах
робототехники\cite{Robotics} и других приложениях, где необходимо понимание
окружающего простанства по видео.
Одно из применений трекинг находит в создании видеоэффектов в кино, где часто
требуется отследить на видео некоторый объект с целью придания ему затем
дополнительных свойств\cite{Bugaev_2018_ECCV}.

Данная работа посвящена одной из задач, касающихся упомянутой проблемы "---
рекурсивному трекингу 6D-позиции заданного 3D-моделью объекта на RGB-видео.
Выражение «6D-позиция» происходит от того, что положение объекта в трехмерном
пространстве имеет шесть степеней свободы.
Входными данными данной задачи являются видео, снятое с единственной
камеры с известными параметрами, 3D-модель отслеживаемого объекта
и его позиция в трехмерном пространстве на начальном кадре видео.
Целью задачи является последовательное вычисление позиции объекта относительно
камеры в каждом кадре видео.

Наличие лишь одного кадра с доподлинно известной позицией объекта и
последовательное вычисление позиций являются важными отличительными
особенностями рассматриваемой задачи.
В то же время нередко рассматривается ее постановка, подразумевающая наличие
дополнительных \term{ключевых кадров} "--- нескольких изображений с известной
позицией объекта относительно камеры.
Дополнительная входная информация обычно дает возможность получать более
качественное решение, однако у требущих наличия ключевых кадров методов область
возможного применения несколько уже.
Тем не менее в основном методы решения задачи в обоих вариантах используют
общие идеи, поэтому при ссылках на связанные работы данное различие будет
упоминаться только в случае необходимости.

Рассматриваемая задача подразумевает, что отслеживаемый объект может быть
произвольным, и на момент начала трекинга задано лишь одно (или небольшое
число, если есть ключевые кадры) изображение с известной позицией объекта,
что значительно усложняет возможность применения машинного обучения.
В связи с этим известные на текущий момент методы решения задачи опираются на
классические методы компьютерного зрения.
Их можно классифицировать в зависимости от того, на какого рода особенности
изображения они опираются "--- цветовые, точечные, граничные и т.\,п.
Различные особенности позволяют в разной степени противостоять возможным
случаям, представляющим существенные сложности для алгоритмов трекинга.
Такими являются захламленный фон, смазывание видео при быстром движении,
быстрая перемена освещения, предметы, перекрывающие объект,
однородная текстура объекта, его симметричная форма.

Некоторые алгоритмы\cite{Vacchetti2004,Lourakis2013,Pauwels2013}
используют точечные особенности изображения (ключевые или особые точки).
Они выделяют на поверхности объекта небольшие хорошо различимые
участки\cite{AKAZE,SIFT,ShiAndTomasi} и отслеживают их перемещение от кадра
к кадру\cite{TomasiAndKanade,SIFT,PyrLK}.
Позиция объекта восстанавливается на основе знания о расположении данных
участков на кадре и соответствующих им точках на 3D-модели\cite{EPnP}.
Такие методы лучше других справляются с перекрытиями и симметричной формой,
но при этом требуют наличия неоднородной текстуры объекта.

В то же время многие объекты имеют характерную форму, которая позволяет
определять их позицию путем сопоставления контуров 3D-модели
и границ\cite{EdgesSurvey,CANNY} изображения объекта на кадре.
Такие методы\cite{RAPID,Marchand2003,Choi2012,Marchand2006,Klein2006,SeoHinterstoisser2014,WangZhong2015,Damen2012,VacchettiEdges2004}
позволяют производить трекинг даже если поверхность объекта окрашена однородно.
В то же время подобные алгоритмы нередко дают сбои при наличии захламленного
фона и при возникновении неоднозначностей в определении позиций
симметричных объектов.

В последние годы активно развиваются алгоритмы, основанные на
распределении цветов в отдельных областях
изображения\cite{PWP3D,Tjaden2017,Tjaden2018}.
Также их иногда называют методами, основанными на регионах изображения.
Они собирают статистику того, насколько часто пиксели различных цветов
встречаются на проекции объекта и на окружающем фоне.
На каждом новом кадре позиция ищется таким образом, чтобы проекция объекта
наилучшим образом соответствовала собранной статистике.
Как правило вычисление позиции производится путем численной оптимизации
функции энергии, имеющей вероятностную интерпретацию.
Такие методы хорошо справляются с однородно окрашенными объектами, если их цвет
отличается от цвета фона, а также лучше других противостоят смазыванию при
быстром движении объектов.
В то же время они плохо справляются с симметричными объектами и неустойчивы к
резкой смене освещения.

Таким образом, различные типы методов по-разному справляются со сложными
условиями трекинга.
Там, где один сбивается, другой может работать стабильно.  В связи с этим
многие работы\cite{RegionPhotometric,ColorFeature2018,Bugaev_2018_ECCV}
посвящены комбинированным алгоритмам, совмещающим в себе различные типы
методов.

В данной работе предлагается способ совмещения трекинга с помощью
точечных особенностей и трекинга на основе распределения цветов.

Вычисление позиции в цветовых методах производится с помощью оптимизации
функции энергии, что требует достаточно хорошего начального приближения.
Как правило, чем ближе это приближение к искомому оптимуму, тем быстрее
сходится оптимизация и тем меньше вероятность попадания в локальный оптимум или
ложный оптимум, возникший из-за симметричности объекта.
В качестве начального приближения предлагается использовать одну из двух
позиций: вычисленную с помощью точечного алгоритма и полученную путем
экстраполяции по двум предыдущим кадрам.
Выбор осуществляется путем сравнения значений функции цветовой энергии в данных
позициях.
В случае, когда точечный алгоритм работает хорошо, он с большой вероятностью
даст очень хорошее приближение для цветового.
В противном случае "--- особенно при смазывании объекта вследствие
быстрого движения "--- экстраполяция может оказаться лучше.
После задания начального приближения производится вычисление результирующей
позиции с помощью цветового алгоритма.
Далее выполняется согласование точечного алгоритма с данной позицией, состоящее
из трех частей: исключение из рассмотрения ставших невидимыми точек,
добавление новых точек и коррекция позиций точек на поверхности 3D-модели.
При этом коррекции подвергаются лишь точки, для которых улучшается
критерий, отражающий ошибку точки на текущем и предыдущих кадрах.
\Comment{TODO: подправить последнее предложение.}

Также предлагается способ значительно сократить потребление оперативной памяти
цветовой частью алгоритма в случае работы с высокополигональными 3D-моделями.
\Comment{Описать остальные нововведения.}

Для анализа эффективности предлагаемого подхода производится тестирование
на открытом наборе данных OPT\cite{OPT}.
Эксперименты показывают, что предлагаемый комбинированный подход дает
результаты, превышающие результаты каждого из составляющих его методов по
отдельности.
\Comment{Добавить конкретные цифры?}

Далее, в разделе \ref{related-work}, обсуждаются связанные с данной статьей
работы.
Затем в разделе \ref{formalization} дается формальная постановка задачи
трекинга и вводятся используемые обозначения.
Раздел \ref{tracking} содержит подробное описание предлагаемого решения.
Наконец, раздел \ref{experiments} содержит результаты экспериментов и сравнение
с другими подходами к трекингу.
